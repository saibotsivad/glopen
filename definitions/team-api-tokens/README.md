# Team API Tokens

These routes manage tokens that are owned and managed by members of a team, as opposed to being owned by a single user.

To use in `glopen` (see [example config file](./example-glopen.config.js)):

```js
// glopen.config.js
import { shared } from '@saibotsivad/glopen-definitions-shared'
import { teams } from '@saibotsivad/glopen-definitions-teams'
import { teamApiTokens } from '@saibotsivad/glopen-definitions-team-api-tokens'
export default {
	merge: [
		...shared(),
		...teams({
			api: '/api/v1' // optional
		}),
		...teamApiTokens({
			api: '/api/v1' // optional
		}),
	],
}
```

The OpenAPI parts are:

- [`parameters: apiTokenId`](./openapi/components/parameters/apiTokenId.@.js)
- [`schemas: apiToken`](./openapi/components/schemas/apiToken.@.js)
- [`tag: teamApiTokens`](./openapi/tags.@.js)
- [shared components](../_shared/README.md)

The routes are:

#### [`GET /teams/{teamId}/apiTokens`](openapi/paths/teams/{teamId}/apiTokens/get.@.js)

Fetch the list of API tokens managed by the team, if the user is a member of that team.

- `request.controller.apiToken.list: (request: Request) => { apiTokens: Array<ApiTokens> }`

#### [`POST /teams/{teamId}/apiTokens`](openapi/paths/teams/{teamId}/apiTokens/post.@.js)

Create a new API token, which will be managed by the team identified in the path. The requesting user must be a member of that team.

The token secret is generated by the server, and is returned as a separate property, visible only one time on this response.

- `request.controller.apiToken.create: (request: Request) => { apiToken: ApiToken, secret: String }`

#### [`DELETE /teams/{teamId}/apiTokens/{apiTokenId}`](openapi/paths/teams/{teamId}/apiTokens/{apiTokenId}/delete.@.js)

Delete an API token owned by the team, if the requesting user is a member.

- `request.controller.apiToken.remove: (request: Request) => null`

#### [`PATCH /teams/{teamId}/apiTokens/{apiTokenId}`](openapi/paths/teams/{teamId}/apiTokens/{apiTokenId}/patch.@.js)

Sparse update to an API token owned by the team, if the requesting user is a member.

The token secret is generated by the server, and is returned as a separate property, visible only one time on this response.

- `request.controller.apiToken.sparseUpdate: (request: Request) => { apiToken: ApiToken, secret: String }`
